{"version":3,"file":"transaction.js","sourceRoot":"","sources":["../../../../src/programs/tokenManager/transaction.ts"],"names":[],"mappings":";;;AAAA,kDAA2C;AAI3C,uCAA4C;AAC5C,yCAA4C;AAC5C,+CAAgD;AAChD,+BAA0C;AAEnC,MAAM,mBAAmB,GAAG,KAAK,EACtC,WAAwB,EACxB,UAAsB,EACtB,MAAc,EACd,IAAe,EACa,EAAE;IAC9B,MAAM,CAAC,aAAa,CAAC,GAAG,MAAM,IAAA,uBAAiB,EAAC,IAAI,CAAC,CAAC;IACtD,MAAM,eAAe,GAAG,MAAM,IAAA,qBAAa,EAAC,GAAG,EAAE,CAC/C,IAAA,yBAAc,EAAC,UAAU,EAAE,aAAa,CAAC,CAC1C,CAAC;IACF,IAAI,CAAC,eAAe,EAAE;QACpB,WAAW,CAAC,GAAG,CAAC,MAAM,IAAA,6BAAe,EAAC,UAAU,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC,CAAC;KAClE;IACD,OAAO,CAAC,CAAA,eAAe,aAAf,eAAe,uBAAf,eAAe,CAAE,MAAM,CAAC,KAAK,KAAI,IAAI,WAAE,CAAC,CAAC,CAAC,EAAE,WAAW,CAAC,CAAC;AACnE,CAAC,CAAC;AAdW,QAAA,mBAAmB,uBAc9B","sourcesContent":["import { BN } from \"@project-serum/anchor\";\nimport type { Wallet } from \"@saberhq/solana-contrib\";\nimport type { Connection, PublicKey, Transaction } from \"@solana/web3.js\";\n\nimport { tryGetAccount } from \"../../utils\";\nimport { getMintCounter } from \"./accounts\";\nimport { initMintCounter } from \"./instruction\";\nimport { findMintCounterId } from \"./pda\";\n\nexport const withInitMintCounter = async (\n  transaction: Transaction,\n  connection: Connection,\n  wallet: Wallet,\n  mint: PublicKey\n): Promise<[BN, Transaction]> => {\n  const [mintCounterId] = await findMintCounterId(mint);\n  const mintCounterData = await tryGetAccount(() =>\n    getMintCounter(connection, mintCounterId)\n  );\n  if (!mintCounterData) {\n    transaction.add(await initMintCounter(connection, wallet, mint));\n  }\n  return [mintCounterData?.parsed.count || new BN(0), transaction];\n};\n"]}